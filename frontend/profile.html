<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω–∞ —Å—Ç–æ—Ä—ñ–Ω–∫–∞ ‚Äî Zlagoda store</title>

    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <!-- –û—Å–Ω–æ–≤–Ω–∏–π —Å—Ç–∏–ª—å -->
    <link rel="stylesheet" type="text/css" href="css/profile.css">
</head>
<body>

    <!-- Header -->
    <header class="header">
        <a href="index.html" class="logo"> <i class="fa fa-shopping-basket"></i>Zlagoda </a>
            <nav class="navbar">
            <a href="index.html#home">Home</a>
            <a href="index.html#features">Features</a>
            <a href="index.html#products">Products</a>
            <a href="index.html#categories">Categories</a>
            <a href="index.html#reviews">Reviews</a>
        </nav>
        <div class="fa fa-user"></div>
        </div>
    </header>

    <!-- Personal Profile Section -->
    <section class="features user-section">
        <h1 class="heading">–ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω–∞ <span>—Å—Ç–æ—Ä—ñ–Ω–∫–∞</span></h1>
        <a href="index.html" class="btn home-btn">–ù–∞ –≥–æ–ª–æ–≤–Ω—É</a>
        <div class="box-container">
            <div class="box" id="profile-view">
                <button id="edit-btn" class="edit-btn"><i class="fa fa-pencil"></i> –†–µ–¥–∞–≥—É–≤–∞—Ç–∏</button>
                <p><strong>–ü–Ü–ë:</strong> –Ü–≤–∞–Ω –Ü–≤–∞–Ω–µ–Ω–∫–æ</p>
                <p><strong>Email:</strong> ivan.ivanenko@example.com</p>
                <p><strong>–¢–µ–ª–µ—Ñ–æ–Ω:</strong> +380123456789</p>
                <p><strong>–î–∞—Ç–∞ –Ω–∞—Ä–æ–¥–∂–µ–Ω–Ω—è:</strong> 1990-01-01</p>
                <p><strong>–ê–¥—Ä–µ—Å–∞:</strong> –º. –ö–∏—ó–≤, –≤—É–ª. –•—Ä–µ—â–∞—Ç–∏–∫, 1</p>
                <p><strong>–†–æ–ª—å:</strong> –ú–µ–Ω–µ–¥–∂–µ—Ä</p>
            </div>
            <div class="box" id="profile-edit" style="display:none;">
                <form class="user-form" id="edit-form">
                    <div class="form-group">
                        <label for="full-name">–ü–Ü–ë</label>
                        <input type="text" id="full-name" name="full-name" value="–Ü–≤–∞–Ω –Ü–≤–∞–Ω–µ–Ω–∫–æ" required>
                    </div>
                    <div class="form-group">
                        <label for="email">Email</label>
                        <input type="email" id="email" name="email" value="ivan.ivanenko@example.com" required>
                    </div>
                    <div class="form-group">
                        <label for="phon">–¢–µ–ª–µ—Ñ–æ–Ω</label>
                        <input type="tel" id="phon" name="phone" value="+380123456789" required>
                    </div>
                    <div class="form-group">
                        <label for="dob">–î–∞—Ç–∞ –Ω–∞—Ä–æ–¥–∂–µ–Ω–Ω—è</label>
                        <input type="date" id="dob" name="dob" value="1990-01-01" required>
                    </div>
                    <div class="form-group">
                        <label for="address">–ê–¥—Ä–µ—Å–∞</label>
                        <input type="text" id="address" name="address" value="–º. –ö–∏—ó–≤, –≤—É–ª. –•—Ä–µ—â–∞—Ç–∏–∫, 1" required>
                    </div>
                    <div class="form-group">
                        <label for="old-password">–°—Ç–∞—Ä–∏–π –ø–∞—Ä–æ–ª—å</label>
                        <input type="password" id="old-password" name="old-password" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢">
                    </div>
                    <div class="form-group">
                        <label for="new-password">–ù–æ–≤–∏–π –ø–∞—Ä–æ–ª—å</label>
                        <input type="password" id="new-password" name="new-password" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢">
                    </div>
                    <div class="form-actions">
                        <button type="submit" class="btn">–ó–±–µ—Ä–µ–≥—Ç–∏</button>
                        <button type="button" class="btn cancel-btn" id="cancel-btn">–°–∫–∞—Å—É–≤–∞—Ç–∏</button>
                    </div>
                </form>
            </div>
        </div>

        <button id="load-products-btn" class="btn">–û—Ç—Ä–∏–º–∞—Ç–∏ –≤—Å—ñ —Ç–æ–≤–∞—Ä–∏</button>
        <button id="show-add-product-form" class="btn">–î–æ–¥–∞—Ç–∏ –Ω–æ–≤–∏–π —Ç–æ–≤–∞—Ä</button>
        <button id="delete-by-id-btn" class="btn" style="margin-top: 20px;">–í–∏–¥–∞–ª–∏—Ç–∏ —Ç–æ–≤–∞—Ä –ø–æ ID</button>
        <button id="filter-by-category-btn" class="btn" style="margin-top: 20px;">–ü–æ–∫–∞–∑–∞—Ç–∏ —Ç–æ–≤–∞—Ä–∏ –∫–∞—Ç–µ–≥–æ—Ä—ñ—ó</button>
        <button id="show-products-by-category-btn" class="btn" style="margin-top: 20px;">
            –ü–æ–∫–∞–∑–∞—Ç–∏ —Ç–æ–≤–∞—Ä–∏ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä—ñ—è—Ö
        </button>




        <div id="add-product-form-container" style="display: none; margin-top: 20px;">
            <form id="add-product-form" class="user-form">
                <div class="form-group">
                    <label for="product-id">Id</label>
                    <input type="number" id="product-id" name="product_id" required>
                </div>
                <div class="form-group">
                    <label for="product-name">–ù–∞–∑–≤–∞ —Ç–æ–≤–∞—Ä—É</label>
                    <input type="text" id="product-name" name="product_name" required>
                </div>
                <div class="form-group">
                    <label for="characteristics">–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏</label>
                    <input type="text" id="characteristics" name="characteristics">
                </div>
                <div class="form-group">
                    <label for="category-number">–ù–æ–º–µ—Ä –∫–∞—Ç–µ–≥–æ—Ä—ñ—ó</label>
                    <input type="number" id="category-number" name="category_number" required>
                </div>
                <div class="form-actions">
                    <button type="submit" class="btn">–ó–±–µ—Ä–µ–≥—Ç–∏</button>
                    <button type="button" class="btn cancel-btn" id="cancel-add-form">–°–∫–∞—Å—É–≤–∞—Ç–∏</button>
                </div>
            </form>
        </div>

        <div id="products-table-container" class="table-container"></div>
        <div id="category-products-container" class="table-container" style="margin-top: 20px;"></div>
        <div id="products-by-category-container" class="table-container" style="margin-top: 20px; display: none;"></div>

        <button id="load-employees-btn" class="btn">–û—Ç—Ä–∏–º–∞—Ç–∏ –≤—Å—ñ—Ö —Å–ø—ñ–≤—Ä–æ–±—ñ—Ç–Ω–∏–∫—ñ–≤</button>
        <button id="show-add-employee-form" class="btn">–î–æ–¥–∞—Ç–∏ –Ω–æ–≤–æ–≥–æ —Å–ø—ñ–≤—Ä–æ–±—ñ—Ç–Ω–∏–∫–∞</button>
        <button id="delete-employee-btn" class="btn" style="margin-top: 20px;">–í–∏–¥–∞–ª–∏—Ç–∏ –ø—Ä–∞—Ü—ñ–≤–Ω–∏–∫–∞ –ø–æ ID</button>
        <button id="show-employees-by-role-btn" class="btn" style="margin-top: 20px;">
            –ü–æ–∫–∞–∑–∞—Ç–∏ —Å–ø—ñ–≤—Ä–æ–±—ñ—Ç–Ω–∏–∫—ñ–≤ –ø–æ —Ä–æ–ª—è—Ö
        </button>


        <div id="add-employee-form-container" style="display: none; margin-top: 20px;">
            <form id="add-employee-form" class="user-form">
                <div class="form-group">
                    <label for="employeeId">Id</label>
                    <input type="number" id="employeeId" name="employeeId" required>
                </div>
                <div class="form-group">
                    <label for="surname">–ü—Ä—ñ–∑–≤–∏—â–µ</label>
                    <input type="text" id="surname" name="surname" required>
                </div>
                <div class="form-group">
                    <label for="name">–Ü–º‚Äô—è</label>
                    <input type="text" id="name" name="name" required>
                </div>
                <div class="form-group">
                    <label for="patronymic">–ü–æ –±–∞—Ç—å–∫–æ–≤—ñ</label>
                    <input type="text" id="patronymic" name="patronymic">
                </div>
                <div class="form-group">
                    <label for="role">–ü–æ—Å–∞–¥–∞</label>
                    <input type="text" id="role" name="role" required>
                </div>
                <div class="form-group">
                    <label for="salary">–ó–∞—Ä–ø–ª–∞—Ç–∞</label>
                    <input type="number" id="salary" name="salary" required>
                </div>
                <div class="form-group">
                    <label for="birth">–î–∞—Ç–∞ –Ω–∞—Ä–æ–¥–∂–µ–Ω–Ω—è</label>
                    <input type="date" id="birth" name="birth" required>
                </div>
                <div class="form-group">
                    <label for="start">–î–∞—Ç–∞ –ø–æ—á–∞—Ç–∫—É —Ä–æ–±–æ—Ç–∏</label>
                    <input type="date" id="start" name="start" required>
                </div>
                <div class="form-group">
                    <label for="phone">–¢–µ–ª–µ—Ñ–æ–Ω</label>
                    <input type="tel" id="phone" name="phone" required>
                </div>
                <div class="form-group">
                    <label for="city">–ú—ñ—Å—Ç–æ</label>
                    <input type="text" id="city" name="city" required>
                </div>
                <div class="form-group">
                    <label for="street">–í—É–ª–∏—Ü—è</label>
                    <input type="text" id="street" name="street" required>
                </div>
                <div class="form-group">
                    <label for="zip">–ü–æ—à—Ç–æ–≤–∏–π —ñ–Ω–¥–µ–∫—Å</label>
                    <input type="text" id="zip" name="zip" required>
                </div>
                <div class="form-actions">
                    <button type="submit" class="btn">–ó–±–µ—Ä–µ–≥—Ç–∏</button>
                    <button type="button" class="btn cancel-btn" id="cancel-add-employee">–°–∫–∞—Å—É–≤–∞—Ç–∏</button>
                </div>
            </form>
        </div>


        <div id="employees-table-container" class="table-container"></div>
        <div id="employees-by-role-container" class="table-container" style="margin-top: 20px; display: none;"></div>

        <button id="show-categories-btn" class="btn" style="margin-top: 20px;">–ü–æ–∫–∞–∑–∞—Ç–∏ –≤—Å—ñ –∫–∞—Ç–µ–≥–æ—Ä—ñ—ó</button>
        <button id="show-add-category-form-btn" class="btn" style="margin-top: 20px;">–î–æ–¥–∞—Ç–∏ –Ω–æ–≤—É –∫–∞—Ç–µ–≥–æ—Ä—ñ—é</button>
        <button id="delete-category-btn" class="btn" style="margin-top: 20px;">–í–∏–¥–∞–ª–∏—Ç–∏ –∫–∞—Ç–µ–≥–æ—Ä—ñ—é</button>


        <div id="add-category-form-container" style="display: none; margin-top: 20px;">
            <form id="add-category-form" class="user-form">
                <div class="form-group">
                    <label for="category-num">ID –∫–∞—Ç–µ–≥–æ—Ä—ñ—ó</label>
                    <input type="text" id="category-num" name="category_num" required>
                </div>
                <div class="form-group">
                    <label for="category-name">–ù–∞–∑–≤–∞ –∫–∞—Ç–µ–≥–æ—Ä—ñ—ó</label>
                    <input type="text" id="category-name" name="category_name" required>
                </div>
                <div class="form-actions">
                    <button type="submit" class="btn">–ó–±–µ—Ä–µ–≥—Ç–∏</button>
                    <button type="button" class="btn cancel-btn" id="cancel-add-category">–°–∫–∞—Å—É–≤–∞—Ç–∏</button>
                </div>
            </form>
        </div>


        <div id="categories-container" class="table-container" style="margin-top: 20px;"></div>



    </section>

    <!-- Script -->
    <script>
        const editBtn = document.getElementById('edit-btn');
        const cancelBtn = document.getElementById('cancel-btn');
        const viewBox = document.getElementById('profile-view');
        const editBox = document.getElementById('profile-edit');

        editBtn.addEventListener('click', () => {
            viewBox.style.display = 'none';
            editBox.style.display = 'block';
        });
        cancelBtn.addEventListener('click', () => {
            editBox.style.display = 'none';
            viewBox.style.display = 'block';
        });

        const showAddBtn = document.getElementById('show-add-product-form');
        const addFormContainer = document.getElementById('add-product-form-container');
        const cancelAddBtn = document.getElementById('cancel-add-form');
        const addForm = document.getElementById('add-product-form');

        showAddBtn.addEventListener('click', () => {
            addFormContainer.style.display = 'block';
        });

        cancelAddBtn.addEventListener('click', () => {
            addForm.reset();
            addFormContainer.style.display = 'none';
        });

        // –í—ñ–¥–ø—Ä–∞–≤–∫–∞ —Ñ–æ—Ä–º–∏
        addForm.addEventListener('submit', async (e) => {
            e.preventDefault();


            const id_product = document.getElementById('product-id').value;
            const product_name = document.getElementById('product-name').value;
            const characteristics = document.getElementById('characteristics').value;
            const category_number = document.getElementById('category-number').value;

            try {
                const response = await fetch('http://localhost:3000/api/products', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({id_product, product_name, characteristics, category_number })
                });

                if (!response.ok) throw new Error('–ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –¥–æ–¥–∞–≤–∞–Ω–Ω—ñ —Ç–æ–≤–∞—Ä—É');
                const newProduct = await response.json();

                alert(`‚úÖ –¢–æ–≤–∞—Ä –¥–æ–¥–∞–Ω–æ: ${newProduct.product_name}`);
                addForm.reset();
                addFormContainer.style.display = 'none';
            } catch (error) {
                alert('‚ùå ' + error.message);
                console.error(error);
            }
        });

        const deleteByIdBtn = document.getElementById('delete-by-id-btn');

        deleteByIdBtn.addEventListener('click', async () => {
            const id = prompt("–í–≤–µ–¥—ñ—Ç—å ID —Ç–æ–≤–∞—Ä—É –¥–ª—è –≤–∏–¥–∞–ª–µ–Ω–Ω—è:");

            if (id === null) {
                // –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á —Å–∫–∞—Å—É–≤–∞–≤ prompt
                return;
            }

            if (id.trim() === '') {
                alert("ID –Ω–µ –º–æ–∂–µ –±—É—Ç–∏ –ø–æ—Ä–æ–∂–Ω—ñ–º!");
                return;
            }

            const confirmDelete = confirm(`–í–∏ –≤–ø–µ–≤–Ω–µ–Ω—ñ, —â–æ —Ö–æ—á–µ—Ç–µ –≤–∏–¥–∞–ª–∏—Ç–∏ —Ç–æ–≤–∞—Ä –∑ ID ${id.trim()}?`);
            if (!confirmDelete) return;

            try {
                const response = await fetch(`http://localhost:3000/api/products/${id.trim()}`, {
                    method: 'DELETE'
                });

                if (response.status === 204) {
                    alert('–¢–æ–≤–∞—Ä —É—Å–ø—ñ—à–Ω–æ –≤–∏–¥–∞–ª–µ–Ω–æ!');
                    // –ú–æ–∂–µ—à —Ç—É—Ç –æ–Ω–æ–≤–∏—Ç–∏ —Å–ø–∏—Å–æ–∫ —Ç–æ–≤–∞—Ä—ñ–≤, —è–∫—â–æ –≤—ñ–Ω —î
                } else {
                    const errData = await response.json();
                    alert('–ü–æ–º–∏–ª–∫–∞ –≤–∏–¥–∞–ª–µ–Ω–Ω—è: ' + (errData.error || response.statusText));
                }
            } catch (error) {
                alert('–ü–æ–º–∏–ª–∫–∞: ' + error.message);
            }
        });


        const loadBtn = document.getElementById('load-products-btn');
        const tableContainer = document.getElementById('products-table-container');

        loadBtn.addEventListener('click', async () => {
            try {
                const response = await fetch('http://localhost:3000/api/products'); // –∑–≤–µ—Ä—Ç–∞—î–º–æ—Å—å –¥–æ –±–µ–∫–µ–Ω–¥—É
                if (!response.ok) throw new Error('–ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –æ—Ç—Ä–∏–º–∞–Ω–Ω—ñ —Ç–æ–≤–∞—Ä—ñ–≤');
                const products = await response.json();

                if (!products.length) {
                    tableContainer.innerHTML = "<p>–ù–µ–º–∞—î —Ç–æ–≤–∞—Ä—ñ–≤ –¥–ª—è –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è.</p>";
                    return;
                }

                let tableHTML = `<table border="1">
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>–ù–∞–∑–≤–∞</th>
                        <th>–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏</th>
                        <th>–ö–∞—Ç–µ–≥–æ—Ä—ñ—è</th>
                    </tr>
                </thead>
                <tbody>`;

                products.forEach(product => {
                    tableHTML += `
                    <tr>
                        <td>${product.id_product}</td>
                        <td>${product.product_name}</td>
                        <td>${product.characteristics}</td>
                        <td>${product.category_number}</td>
                    </tr>`;
                });

                tableHTML += "</tbody></table>";
                tableContainer.innerHTML = tableHTML;

            } catch (error) {
                tableContainer.innerHTML = `<p style="color:red;">${error.message}</p>`;
                console.error(error);
            }
        });

        const filterByCategoryBtn = document.getElementById('filter-by-category-btn');
        const categoryProductsContainer = document.getElementById('category-products-container');

        filterByCategoryBtn.addEventListener('click', async () => {
            const categoryNumber = prompt("–í–≤–µ–¥—ñ—Ç—å –Ω–æ–º–µ—Ä –∫–∞—Ç–µ–≥–æ—Ä—ñ—ó –¥–ª—è –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è —Ç–æ–≤–∞—Ä—ñ–≤:");

            if (categoryNumber === null) return; // –°–∫–∞—Å–æ–≤–∞–Ω–æ

            if (categoryNumber.trim() === '') {
                alert("–ù–æ–º–µ—Ä –∫–∞—Ç–µ–≥–æ—Ä—ñ—ó –Ω–µ –º–æ–∂–µ –±—É—Ç–∏ –ø–æ—Ä–æ–∂–Ω—ñ–º!");
                return;
            }

            try {
                const response = await fetch(`http://localhost:3000/api/products/category/${categoryNumber.trim()}`);
                if (!response.ok) throw new Error('–ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –æ—Ç—Ä–∏–º–∞–Ω–Ω—ñ —Ç–æ–≤–∞—Ä—ñ–≤ –∫–∞—Ç–µ–≥–æ—Ä—ñ—ó');

                const products = await response.json();

                if (products.length === 0) {
                    categoryProductsContainer.innerHTML = `<p>–¢–æ–≤–∞—Ä–∏ –≤ –∫–∞—Ç–µ–≥–æ—Ä—ñ—ó ${categoryNumber.trim()} –≤—ñ–¥—Å—É—Ç–Ω—ñ.</p>`;
                    return;
                }

                let tableHTML = `<table border="1" style="width:100%; border-collapse: collapse;">
            <thead>
                <tr>
                    <th>ID</th>
                    <th>–ù–∞–∑–≤–∞</th>
                    <th>–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏</th>
                    <th>–ö–∞—Ç–µ–≥–æ—Ä—ñ—è</th>
                </tr>
            </thead>
            <tbody>`;

                products.forEach(product => {
                    tableHTML += `
                <tr>
                    <td>${product.id_product}</td>
                    <td>${product.product_name}</td>
                    <td>${product.characteristics}</td>
                    <td>${product.category_number}</td>
                </tr>`;
                });

                tableHTML += '</tbody></table>';
                categoryProductsContainer.innerHTML = tableHTML;

            } catch (error) {
                categoryProductsContainer.innerHTML = `<p style="color:red;">${error.message}</p>`;
                console.error(error);
            }
        });

        const showProductsByCategoryBtn = document.getElementById("show-products-by-category-btn");
        const productsByCategoryContainer = document.getElementById("products-by-category-container");

        showProductsByCategoryBtn.addEventListener("click", async () => {
            if (productsByCategoryContainer.style.display === "block") {
                productsByCategoryContainer.style.display = "none";
                productsByCategoryContainer.innerHTML = "";
                return;
            }

            try {
                const res = await fetch("http://localhost:3000/api/products/by-category");
                const data = await res.json();

                if (!Array.isArray(data) || data.length === 0) {
                    productsByCategoryContainer.innerHTML = "<p>–¢–æ–≤–∞—Ä—ñ–≤ –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ.</p>";
                    productsByCategoryContainer.style.display = "block";
                    return;
                }

                // –ì—Ä—É–ø—É–≤–∞–Ω–Ω—è —Ç–æ–≤–∞—Ä—ñ–≤ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä—ñ—è—Ö
                const categoriesMap = {};
                data.forEach(product => {
                    const category = product.category_name || "–ë–µ–∑ –∫–∞—Ç–µ–≥–æ—Ä—ñ—ó";
                    if (!categoriesMap[category]) categoriesMap[category] = [];
                    categoriesMap[category].push(product);
                });

                let html = "";

                for (const [categoryName, products] of Object.entries(categoriesMap)) {
                    html += `<h3>–ö–∞—Ç–µ–≥–æ—Ä—ñ—è: ${categoryName}</h3>`;
                    html += `<table class="product-table">
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>–ù–∞–∑–≤–∞ —Ç–æ–≤–∞—Ä—É</th>
                        <th>–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏</th>
                    </tr>
                </thead>
                <tbody>`;

                    products.forEach(p => {
                        html += `
                    <tr>
                        <td>${p.id_product}</td>
                        <td>${p.product_name}</td>
                        <td>${p.characteristics || ""}</td>
                    </tr>`;
                    });

                    html += `</tbody></table><br>`;
                }

                productsByCategoryContainer.innerHTML = html;
                productsByCategoryContainer.style.display = "block";
            } catch (err) {
                productsByCategoryContainer.innerHTML = `<p style="color:red;">–ü–æ–º–∏–ª–∫–∞: ${err.message}</p>`;
                productsByCategoryContainer.style.display = "block";
            }
        });


        const showAddEmployeeBtn = document.getElementById('show-add-employee-form');
        const addEmployeeFormContainer = document.getElementById('add-employee-form-container');
        const cancelAddEmployeeBtn = document.getElementById('cancel-add-employee');
        const addEmployeeForm = document.getElementById('add-employee-form');

        showAddEmployeeBtn.addEventListener('click', () => {
            addEmployeeFormContainer.style.display = 'block';
        });

        cancelAddEmployeeBtn.addEventListener('click', () => {
            addEmployeeForm.reset();
            addEmployeeFormContainer.style.display = 'none';
        });

        addEmployeeForm.addEventListener('submit', async (e) => {
            e.preventDefault();

            const formData = {
                id_employee: addEmployeeForm.employeeId.value,
                empl_surname: addEmployeeForm.surname.value,
                empl_name: addEmployeeForm.name.value,
                empl_patronymic: addEmployeeForm.patronymic.value,
                empl_role: addEmployeeForm.role.value,
                salary: Number(addEmployeeForm.salary.value),
                date_of_birth: addEmployeeForm.birth.value,
                date_of_start: addEmployeeForm.start.value,
                phone_number: addEmployeeForm.phone.value,
                city: addEmployeeForm.city.value,
                street: addEmployeeForm.street.value,
                zip_code: addEmployeeForm.zip.value,
            };

            try {
                const res = await fetch('http://localhost:3000/api/employee', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(formData),
                });

                if (!res.ok) {
                    const errorData = await res.json();
                    throw new Error(errorData.error || '–ù–µ–≤—ñ–¥–æ–º–∞ –ø–æ–º–∏–ª–∫–∞');
                }

                alert('–ü—Ä–∞—Ü—ñ–≤–Ω–∏–∫–∞ –¥–æ–¥–∞–Ω–æ!');
                addEmployeeForm.reset();
                addEmployeeFormContainer.style.display = 'none';
            } catch (err) {
                alert('–ü–æ–º–∏–ª–∫–∞: ' + err.message);
            }
        });


        const employeesBtn = document.getElementById('load-employees-btn');
        const employeesContainer = document.getElementById('employees-table-container');

        employeesBtn.addEventListener('click', async () => {
            try {
                const response = await fetch('http://localhost:3000/api/employee');
                if (!response.ok) throw new Error('–ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –æ—Ç—Ä–∏–º–∞–Ω–Ω—ñ –ø—Ä–∞—Ü—ñ–≤–Ω–∏–∫—ñ–≤');
                const employees = await response.json();

                if (!employees.length) {
                    employeesContainer.innerHTML = "<p>–ù–µ–º–∞—î –ø—Ä–∞—Ü—ñ–≤–Ω–∏–∫—ñ–≤ –¥–ª—è –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è.</p>";
                    return;
                }

                let tableHTML = `<table border="1">
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>–ü—Ä—ñ–∑–≤–∏—â–µ</th>
                        <th>–Ü–º'—è</th>
                        <th>–ü–æ –±–∞—Ç—å–∫–æ–≤—ñ</th>
                        <th>–†–æ–ª—å</th>
                        <th>–ó–∞—Ä–ø–ª–∞—Ç–∞</th>
                        <th>–î–∞—Ç–∞ –Ω–∞—Ä–æ–¥–∂–µ–Ω–Ω—è</th>
                        <th>–î–∞—Ç–∞ –ø–æ—á–∞—Ç–∫—É</th>
                        <th>–¢–µ–ª–µ—Ñ–æ–Ω</th>
                        <th>–ú—ñ—Å—Ç–æ</th>
                        <th>–í—É–ª–∏—Ü—è</th>
                        <th>–Ü–Ω–¥–µ–∫—Å</th>
                    </tr>
                </thead>
                <tbody>`;

                employees.forEach(emp => {
                    tableHTML += `
                    <tr>
                        <td>${emp.id_employee}</td>
                        <td>${emp.empl_surname}</td>
                        <td>${emp.empl_name}</td>
                        <td>${emp.empl_patronymic}</td>
                        <td>${emp.empl_role}</td>
                        <td>${emp.salary}</td>
                        <td>${emp.date_of_birth}</td>
                        <td>${emp.date_of_start}</td>
                        <td>${emp.phone_number}</td>
                        <td>${emp.city}</td>
                        <td>${emp.street}</td>
                        <td>${emp.zip_code}</td>
                    </tr>`;
                });

                tableHTML += "</tbody></table>";
                employeesContainer.innerHTML = tableHTML;

            } catch (error) {
                employeesContainer.innerHTML = `<p style="color:red;">${error.message}</p>`;
                console.error(error);
            }
        });

        const deleteEmployeeBtn = document.getElementById('delete-employee-btn');

        deleteEmployeeBtn.addEventListener('click', async () => {
            const id = prompt("–í–≤–µ–¥—ñ—Ç—å ID –ø—Ä–∞—Ü—ñ–≤–Ω–∏–∫–∞, —è–∫–æ–≥–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ –≤–∏–¥–∞–ª–∏—Ç–∏:");

            if (id === null) return; // –°–∫–∞—Å–æ–≤–∞–Ω–æ
            if (id.trim() === '') {
                alert("ID –Ω–µ –º–æ–∂–µ –±—É—Ç–∏ –ø–æ—Ä–æ–∂–Ω—ñ–º!");
                return;
            }

            const confirmed = confirm(`–í–∏ –≤–ø–µ–≤–Ω–µ–Ω—ñ, —â–æ —Ö–æ—á–µ—Ç–µ –≤–∏–¥–∞–ª–∏—Ç–∏ –ø—Ä–∞—Ü—ñ–≤–Ω–∏–∫–∞ –∑ ID ${id.trim()}?`);
            if (!confirmed) return;

            try {
                const res = await fetch(`http://localhost:3000/api/employee/${id.trim()}`, {
                    method: 'DELETE',
                });

                if (res.status === 204) {
                    alert("–ü—Ä–∞—Ü—ñ–≤–Ω–∏–∫–∞ —É—Å–ø—ñ—à–Ω–æ –≤–∏–¥–∞–ª–µ–Ω–æ!");
                    // –¢—É—Ç –º–æ–∂–Ω–∞ –æ–Ω–æ–≤–∏—Ç–∏ —Å–ø–∏—Å–æ–∫ –ø—Ä–∞—Ü—ñ–≤–Ω–∏–∫—ñ–≤
                } else {
                    const err = await res.json();
                    alert("–ü–æ–º–∏–ª–∫–∞: " + (err.error || res.statusText));
                }
            } catch (err) {
                alert("–ü–æ–º–∏–ª–∫–∞: " + err.message);
            }
        });

        const showEmployeesByRoleBtn = document.getElementById("show-employees-by-role-btn");
        const employeesByRoleContainer = document.getElementById("employees-by-role-container");

        showEmployeesByRoleBtn.addEventListener("click", async () => {
            if (employeesByRoleContainer.style.display === "block") {
                employeesByRoleContainer.style.display = "none";
                employeesByRoleContainer.innerHTML = "";
                return;
            }

            try {
                const res = await fetch("http://localhost:3000/api/employees/by-role");
                const data = await res.json();

                if (!Array.isArray(data) || data.length === 0) {
                    employeesByRoleContainer.innerHTML = "<p>–°–ø—ñ–≤—Ä–æ–±—ñ—Ç–Ω–∏–∫—ñ–≤ –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ.</p>";
                    employeesByRoleContainer.style.display = "block";
                    return;
                }

                const roleMap = {};
                data.forEach(emp => {
                    const role = emp.empl_role || "–ë–µ–∑ —Ä–æ–ª—ñ";
                    if (!roleMap[role]) roleMap[role] = [];
                    roleMap[role].push(emp);
                });

                let html = "";

                for (const [role, employees] of Object.entries(roleMap)) {
                    html += `<h3>–†–æ–ª—å: ${role}</h3>`;
                    html += `<table class="product-table">
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>–ü—Ä—ñ–∑–≤–∏—â–µ</th>
                        <th>–Ü–º‚Äô—è</th>
                        <th>–ü–æ-–±–∞—Ç—å–∫–æ–≤—ñ</th>
                        <th>–¢–µ–ª–µ—Ñ–æ–Ω</th>
                        <th>–î–∞—Ç–∞ –Ω–∞—Ä–æ–¥–∂–µ–Ω–Ω—è</th>
                    </tr>
                </thead>
                <tbody>`;

                    employees.forEach(e => {
                        html += `
                    <tr>
                        <td>${e.id_employee}</td>
                        <td>${e.empl_surname}</td>
                        <td>${e.empl_name}</td>
                        <td>${e.empl_patronymic}</td>
                        <td>${e.phone_number}</td>
                        <td>${e.date_of_birth}</td>
                    </tr>`;
                    });

                    html += `</tbody></table><br>`;
                }

                employeesByRoleContainer.innerHTML = html;
                employeesByRoleContainer.style.display = "block";
            } catch (err) {
                employeesByRoleContainer.innerHTML = `<p style="color:red;">–ü–æ–º–∏–ª–∫–∞: ${err.message}</p>`;
                employeesByRoleContainer.style.display = "block";
            }
        });

        // –∫–∞—Ç–µ–≥–æ—Ä—ñ—ó

        const showCategoriesBtn = document.getElementById('show-categories-btn');
        const categoriesContainer = document.getElementById('categories-container');

        showCategoriesBtn.addEventListener('click', async () => {
            try {
                const response = await fetch('http://localhost:3000/api/category'); // üëà —Ç–≤—ñ–π API-–µ–Ω–¥–ø–æ—ñ–Ω—Ç
                if (!response.ok) throw new Error('–ù–µ –≤–¥–∞–ª–æ—Å—è –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –∫–∞—Ç–µ–≥–æ—Ä—ñ—ó');

                const categories = await response.json();

                if (categories.length === 0) {
                    categoriesContainer.innerHTML = '<p>–ö–∞—Ç–µ–≥–æ—Ä—ñ–π –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ.</p>';
                    return;
                }

                let tableHTML = `<table class="product-table">
            <thead>
                <tr>
                    <th>ID</th>
                    <th>–ù–∞–∑–≤–∞ –∫–∞—Ç–µ–≥–æ—Ä—ñ—ó</th>
                </tr>
            </thead>
            <tbody>`;

                categories.forEach(category => {
                    tableHTML += `
                <tr>
                    <td>${category.category_number}</td>
                    <td>${category.category_name}</td>
                </tr>`;
                });

                tableHTML += `</tbody></table>`;
                categoriesContainer.innerHTML = tableHTML;
            } catch (err) {
                categoriesContainer.innerHTML = `<p style="color: red;">${err.message}</p>`;
            }
        });

        const showAddCategoryFormBtn = document.getElementById('show-add-category-form-btn');
        const addCategoryFormContainer = document.getElementById('add-category-form-container');
        const cancelAddCategoryBtn = document.getElementById('cancel-add-category');
        const addCategoryForm = document.getElementById('add-category-form');

        showAddCategoryFormBtn.addEventListener('click', () => {
            addCategoryFormContainer.style.display = 'block';
        });

        cancelAddCategoryBtn.addEventListener('click', () => {
            addCategoryForm.reset();
            addCategoryFormContainer.style.display = 'none';
        });

        addCategoryForm.addEventListener('submit', async (e) => {
            e.preventDefault();

            const formData = {
                category_number: addCategoryForm.category_num.value.trim(),
                category_name: addCategoryForm.category_name.value.trim()
            };

            try {
                const res = await fetch('http://localhost:3000/api/category', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(formData)
                });

                if (!res.ok) {
                    const error = await res.json();
                    throw new Error(error.error || "–ù–µ–≤—ñ–¥–æ–º–∞ –ø–æ–º–∏–ª–∫–∞");
                }

                alert("–ö–∞—Ç–µ–≥–æ—Ä—ñ—é —É—Å–ø—ñ—à–Ω–æ –¥–æ–¥–∞–Ω–æ!");
                addCategoryForm.reset();
                addCategoryFormContainer.style.display = 'none';
            } catch (err) {
                alert("–ü–æ–º–∏–ª–∫–∞: " + err.message);
            }
        });

        const deleteCategoryBtn = document.getElementById('delete-category-btn');

        deleteCategoryBtn.addEventListener('click', async () => {
            const categoryId = prompt("–í–≤–µ–¥—ñ—Ç—å ID (category_number) –∫–∞—Ç–µ–≥–æ—Ä—ñ—ó, —è–∫—É –ø–æ—Ç—Ä—ñ–±–Ω–æ –≤–∏–¥–∞–ª–∏—Ç–∏:");

            if (categoryId === null) return; // –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –Ω–∞—Ç–∏—Å–Ω—É–≤ ¬´–°–∫–∞—Å—É–≤–∞—Ç–∏¬ª
            if (categoryId.trim() === "") {
                alert("ID –Ω–µ –º–æ–∂–µ –±—É—Ç–∏ –ø–æ—Ä–æ–∂–Ω—ñ–º!");
                return;
            }

            const confirmDelete = confirm(`–í–∏ —Ç–æ—á–Ω–æ —Ö–æ—á–µ—Ç–µ –≤–∏–¥–∞–ª–∏—Ç–∏ –∫–∞—Ç–µ–≥–æ—Ä—ñ—é –∑ ID ${categoryId.trim()}?`);
            if (!confirmDelete) return;

            try {
                const res = await fetch(`http://localhost:3000/api/category/${categoryId.trim()}`, {
                    method: 'DELETE'
                });

                if (res.status === 204) {
                    alert("–ö–∞—Ç–µ–≥–æ—Ä—ñ—é —É—Å–ø—ñ—à–Ω–æ –≤–∏–¥–∞–ª–µ–Ω–æ!");
                } else {
                    const err = await res.json();
                    alert("–ü–æ–º–∏–ª–∫–∞: " + (err.error || "–ù–µ–≤—ñ–¥–æ–º–∞ –ø–æ–º–∏–ª–∫–∞"));
                }
            } catch (err) {
                alert("–ü–æ–º–∏–ª–∫–∞: " + err.message);
            }
        });

    </script>

</body>
</html>
